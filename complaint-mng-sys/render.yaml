services:
  - type: web
    name: complaint-mng-sys
    env: java
    plan: free # Change to starter/standard for production
    buildCommand: ./mvnw clean package -DskipTests
    startCommand: java -Dserver.port=${PORT:-8080} -jar target/complaint-mng-sys-0.0.1-SNAPSHOT.jar

    envVars:
      - key: JAVA_VERSION
        value: "21"
      - key: PORT
        value: "8080"
      - key: DB_URL
        fromDatabase:
          name: complaint-db
          property: connectionString
      - key: DB_USERNAME
        fromDatabase:
          name: complaint-db
          property: user
      - key: DB_PASSWORD
        fromDatabase:
          name: complaint-db
          property: password
      - key: JWT_SECRET
        sync: false  # Set this manually in Render dashboard
      - key: DDL_AUTO
        value: "create" # Creates tables on first deployment, then change to 'update' after successful deployment

databases:
  - name: complaint-db
    databaseName: complaint_db
    user: complaint_user
    plan: free
    postgreSQL: false # Set to true if using PostgreSQL
    # For MySQL, you'll need to configure the connection via environment variables
